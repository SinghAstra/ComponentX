# Color Picker

An accessible, customizable color picker component that combines a color input field with a preset palette in a popover. Perfect for applications that need flexible color selection with both quick preset options and manual hex code entry.

<div className="w-full h-32"></div>

<ComponentPreviewWithCode
  code={`"use client";

import ColorPickerInput from "@/components/color-picker-input";

export function ColorPickerPreview() {
  return (
    <div className="w-full max-w-sm mx-auto">
      <ColorPickerInput
        label="Choose a color"
        defaultColor="#3B82F6"
      />
    </div>
  );
}
`}
>
  <ColorPickerPreview />
</ComponentPreviewWithCode>

<div className="w-full h-32"></div>

## Installation

<Installation
  command="npx cx add color-picker-input"
  code={`"use client";

import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import {
  Popover,
  PopoverContent,
  PopoverTrigger,
} from "@/components/ui/popover";
import { cn } from "@/lib/utils";
import { forwardRef, useEffect, useState } from "react";

export const DEFAULT_COLOR_PRESETS = [
  "#111827",
  "#374151",
  "#6B7280",
  "#9CA3AF",
  "#D1D5DB",
  "#F3F4F6",
  "#EF4444",
  "#F59E0B",
  "#FBBF24",
  "#FCD34D",
  "#34D399",
  "#10B981",
  "#06B6D4",
  "#0EA5E9",
  "#3B82F6",
  "#6366F1",
  "#8B5CF6",
  "#EC4899",
  "#F97316",
  "#22C55E",
  "#84CC16",
  "#14B8A6",
  "#A855F7",
  "#E11D48",
];

export function normalizeHex(input: string): string | null {
  let v = input.trim();
  if (!v) return null;
  if (v[0] !== "#") v = \`#\${v}\`;
  const short = /^#([0-9a-fA-F]{3})$/;
  const long = /^#([0-9a-fA-F]{6})$/;
  if (short.test(v)) {
    const [, s] = v.match(short) as RegExpMatchArray;
    const expanded = \`#\${s[0]}\${s[0]}\${s[1]}\${s[1]}\${s[2]}\${s[2]}\`;
    return expanded.toUpperCase();
  }
  if (long.test(v)) return v.toUpperCase();
  return null;
}

export function isValidHex(input: string): boolean {
  return normalizeHex(input) !== null;
}

interface ColorPickerPopUpProps {
presets: string[];
selectedColor: string;
onColorSelect: (hex: string) => void;
columns?: number;
title?: string;
showHexCode?: boolean;
}

export function ColorPickerPopUp({
  presets,
  selectedColor,
  onColorSelect,
  title = "Pick a color",
  showHexCode = true,
}: ColorPickerPopUpProps) {
  return (
    <div className="space-y-3">
      <div className="flex items-center justify-between">
        <span className="text-sm font-medium">{title}</span>
        {showHexCode && (
          <span className="text-xs text-muted-foreground">{selectedColor}</span>
        )}
      </div>
      <div className={cn(\`grid gap-2\`, \`grid-cols-6\`)}>
        {presets.map((hex) => {
          const selected = selectedColor.toUpperCase() === hex.toUpperCase();
          return (
            <button
              key={hex}
              type="button"
              className={cn(
                "h-8 w-8 rounded-full border hover:ring-1 hover:ring-ring transition-all duration-300 focus:outline-none focus:ring-1 focus:ring-ring",
                selected ? "ring-1 ring-ring" : "ring-0"
              )}
              style={{
                backgroundColor: hex,
              }}
              onClick={() => onColorSelect(hex)}
              aria-label={\`Choose \${hex}\`}
              aria-pressed={selected}
              title={hex}
            />
          );
        })}
      </div>
    </div>
  );
}

interface ColorPopUpTriggerProps {
color: string;
onClick?: () => void;
aria?: {
label?: string;
describedBy?: string;
};
className?: string;
}

export const ColorPopUpTrigger = forwardRef<
  HTMLButtonElement,
  ColorPopUpTriggerProps
>(({ color, onClick, aria, className }, ref) => {
  return (
    <button
      ref={ref}
      type="button"
      className={cn(
        "h-full flex items-center justify-center  bg-transparent hover:bg-accent transition-colors p-1 rounded",
        className
      )}
      onClick={onClick}
      aria-label={aria?.label || "Open color picker"}
      title={color}
      aria-describedby={aria?.describedBy}
    >
      <span
        aria-hidden
        className="block h-8 w-8 rounded"
        style={{
          backgroundColor: color,
        }}
      />
    </button>
  );
});

ColorPopUpTrigger.displayName = "ColorPopUpTrigger";

interface ColorInputProps {
value: string;
onChange: (hex: string) => void;
placeholder?: string;
helpText?: string;
showHelpText?: boolean;
inputId?: string;
}

export function ColorInput({
  value,
  onChange,
  placeholder = "#000000",
  showHelpText = true,
  inputId = "color-input",
}: ColorInputProps) {
  const [internalValue, setInternalValue] = useState(value);

function handleChange(e: React.ChangeEvent<HTMLInputElement>) {
setInternalValue(e.target.value);
}

function handleBlur() {
const normalized = normalizeHex(internalValue);
if (normalized) {
onChange(normalized);
} else {
setInternalValue(value);
}
}

useEffect(() => {
setInternalValue(value);
}, [value]);

return (

<Input
id={inputId}
type="text"
inputMode="text"
spellCheck={false}
placeholder={placeholder}
className={cn("border-0 focus-visible:ring-0")}
value={internalValue}
onChange={handleChange}
onBlur={handleBlur}
pattern="^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$"
aria-describedby={showHelpText ? \`\${inputId}-help\` : undefined}
/>
);
}

interface ColorPickerInputProps {
value?: string;
onChange?: (hex: string) => void;
label?: string;
showLabel?: boolean;
helpText?: string;
showHelpText?: boolean;
presets?: string[];
paletteTitle?: string;
showHexCode?: boolean;
defaultColor?: string;
}

export function ColorPickerInput({
  value,
  onChange,
  label = "Color",
  showLabel = true,
  helpText,
  presets = DEFAULT_COLOR_PRESETS,
  paletteTitle = "Pick a color",
  showHexCode = true,
  defaultColor = "#3B82F6",
}: ColorPickerInputProps) {
  const [colorPickerPopUpOpen, setColorPickerPopUpOpen] = useState(false);
  const [internal, setInternal] = useState<string>(
    normalizeHex(value || defaultColor) || defaultColor
  );
  const current = normalizeHex(value ?? internal) ?? defaultColor;

function commit(next: string) {
const normalized = normalizeHex(next);
if (!normalized) return;
setInternal(normalized);
onChange?.(normalized);
}

return (

<div className="w-full space-y-2">
{showLabel && (
<Label htmlFor="color-input" className="text-sm">
{label}
</Label>
)}
<Popover
        open={colorPickerPopUpOpen}
        onOpenChange={setColorPickerPopUpOpen}
      >
<PopoverTrigger asChild>
<div className="flex px-1 py-0.5 rounded border bg-transparent transition-all duration-300 has-[:focus-visible]:bg-muted/20 has-[:focus-visible]:border-ring ">
<ColorPopUpTrigger
color={internal}
onClick={() => setColorPickerPopUpOpen(true)}
aria={{
                label: \`\${label} picker, currently \${current}\`,
                describedBy: "color-input-help",
              }}
/>
<ColorInput
              value={internal}
              onChange={commit}
              helpText={helpText}
            />
</div>
</PopoverTrigger>
<PopoverContent
          className="w-72 bg-background border rounded shadow-sm"
          align="start"
        >
<ColorPickerPopUp
presets={presets}
selectedColor={current}
onColorSelect={(hex) => {
commit(hex);
setColorPickerPopUpOpen(false);
}}
title={paletteTitle}
showHexCode={showHexCode}
/>
</PopoverContent>
</Popover>
</div>
);
}

export default ColorPickerInput;
`}
/>

<div className="w-full h-32"></div>

## Custom Presets

<ComponentPreviewWithCode
  code={`"use client";

import { useState } from "react";
import ColorPickerInput from "@/components/color-picker-input";

export function ColorPickerCustomPresets() {
  const [color, setColor] = useState('#FF6B35');

const brandColors = [
'#FF6B35',
'#004E89',
'#F77F00',
'#FCBF49',
'#EAE2B7',
'#003049',
'#D62828',
'#F77F00',
];

return (

<div className="w-full max-w-sm">
  <ColorPickerInput
    value={color}
    onChange={setColor}
    label="Brand Colors"
    presets={brandColors}
    paletteTitle="Select a brand color"
  />
</div>
); } `}

>

  <ColorPickerCustomPresets />
</ComponentPreviewWithCode>

<div className="w-full h-32"></div>

## Without Label

<ComponentPreviewWithCode
  code={`"use client";

import { useState } from "react";
import ColorPickerInput from "@/components/color-picker-input";

export function ColorPickerNoLabel() {
const [color, setColor] = useState('#8B5CF6');

return (

<div className="w-full max-w-sm">
  <ColorPickerInput
    value={color}
    onChange={setColor}
    showLabel={false}
    showHexCode={true}
  />
</div>
); } `}

>

  <ColorPickerNoLabel />
</ComponentPreviewWithCode>

<div className="w-full h-32"></div>
